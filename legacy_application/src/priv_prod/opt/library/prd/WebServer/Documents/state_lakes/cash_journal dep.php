<?php$database="state_lakes";include("../../include/connectROOT.inc");// database connection parameters$db = mysql_select_db($database,$connection)       or die ("Couldn't select database $database");extract($_REQUEST);$tab="Reports";if($rep=="")	{	include("menu.php");	}	else	{	header('Content-Type: application/vnd.ms-excel');	header('Content-Disposition: attachment; filename=cash_journal.xls');	}session_start();//echo "<pre>"; print_r($_SESSION); echo "</pre>";  exit;$rcc=$_SESSION['state_lakes']['rcc'];if($park==""){echo "You must select a park.";exit;}if($end_date=="")	{	$end_date=$start_date;	$date_range="for $start_date";	}	else	{	$date_range="from $start_date to $end_date";	}$pass_query="&start_date=$start_date&end_date=$end_date&park=$park";	$default_fields="t1.park,t1.entity,t1.id,t1.billing_title,t1.billing_last_name,t1.billing_first_name,";include("payments_pier.php");include("payments_buoy.php");include("payments_ramp.php");include("payments_seawall.php");include("payments_swim_line.php");$num_pay=count($ARRAY);if($num_pay<1){echo "No payments found $date_range $clause.";exit;}foreach($HEADERS as $k=>$v){	foreach($v as $i=>$var_field)		{		$headers[$var_field]=$i;		}}$h1=array_keys($headers);foreach ($ARRAY as $key => $row) {    $id[$key]  = $row['id'];}array_multisort($id, SORT_ASC, $ARRAY);//echo "<pre>"; print_r($h1); print_r($id); print_r($ARRAY);echo "</pre>";  exit;//echo "<pre>"; print_r($ARRAY); echo "</pre>"; // exit;if($rep=="x"){include("cash_journal_sheet_1.php");}$cs=array("billing_last_name"=>"2","pier_check_number"=>"2");$skip=array("buoy_receipt","ramp_receipt","swim_line_receipt","buoy_check_number","ramp_check_number","swim_line_check_number","number_pier_check","number_buoy_check","number_ramp_check","number_swim_line_check","park","entity","id","billing_title","billing_first_name","pier_fee","buoy_fee","ramp_fee","pier_receipt","buoy_app_fee","pier_transfer_fee","trans_pay_date_receipt","buoy_app_date","pier_trans_pay_date","pier_transfer_check","pier_mod_check","pier_mod_fee","pier_mod_pay_date","swim_line_fee","seawall_pay_date","seawall_check_number","seawall_app_fee","mod_fee_amt","mod_pay_date");echo "<table border='1' cellpadding='2'><tr><th colspan='9'>DETAIL CHECK LIST</th></tr><tr>";	echo "<th colspan='2'>CHECK<BR />NO.</th><th colspan='2'>PAYOR/VENDOR<BR />NAME</th><th colspan='2'>AMOUNT</th><th colspan='3'>Description</th></tr>";	//echo "<pre>"; print_r($ARRAY); echo "</pre>";  //exit;		foreach($ARRAY as $num=>$array)	{		extract($array);				if($id==$ARRAY[$num+1]['id'])			{			$amt.=$pier_fee+$mod_fee_amt+$buoy_fee;			if($billing_title){$bt=$billing_title;}else{$bt=$billing_last_name.", ".$billing_first_name;}			continue;			}		else			{			$amt.=$mod_fee_amt+$buoy_fee;			if($billing_title){$bt=$billing_title;}else{$bt=$billing_last_name.", ".$billing_first_name;}			echo "<tr>			<td colspan='2'>$check_number</td>			<td colspan='2'>$bt</td>			<td colspan='2' align='right'>$amt</td>			<td colspan='3'>PERMIT</td>			</tr>";			}		$grand_total+=$amt;		unset($amt);	}	$gt="$".number_format($grand_total,2);echo "<tr><td colspan='9' align='right'> </td></tr>";echo "<tr><td colspan='6' align='right'><b>$gt</b></td><td colspan='3' align='center'>DETAIL TOTAL CREDITS</td></tr>";echo "</table><table>";if($rep=="")	{	echo "<tr><td colspan='13' align='right'><a href='cash_journal.php?gt=$grand_total&pass_query=$pass_query&rep=x'>Excel</a></td></tr>";	}echo "<tr><td colspan='9' align='left'>Cash Receipts Journal Voucher with Summary</td></tr>";	echo "</table></body></html>";?>