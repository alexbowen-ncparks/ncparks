<?php//echo "<pre>"; print_r($_REQUEST); echo "</pre>";  exit;extract($_REQUEST);IF($rep==""){include("menu.php"); // includes auth and session_start}include("../../include/parkcodesDiv.inc");if($rep==1){//$parkcode="CABE";require('../../fpdf16/fpdf.php');require('../../fpdf16/extend_FPDF.php');}if($f_year==""){$testMonth=date(n);if($testMonth >0 and $testMonth<8){$year2=date(Y)-1;}if($testMonth >7){$year2=date(Y);}$yearNext=$year2+1;$yx=substr($year2,2,2);$year3=$yearNext;$yy=substr($year3,2,2);$f_year=$yx.$yy;if($prev_year=="prev"){$yx=substr(($year2-1),2,2);$yy=substr(($year3-1),2,2);$f_year=$yx.$yy;}$pf_year=$yx=substr(($year2-1),2,2);$yy=substr(($year3-1),2,2);$pf_year=$yx.$yy;}$prev_yr=date(Y)-1; $pent_yr=$prev_yr-1;// ******** Enter your SELECT statement here **********IF($rep==""){foreach($parkCodeName as $k=>$v){	if($k){$menuArrayPark[]=$k;}	}	echo "<form><table cellpadding='2'><tr>";echo "<td align='center'><select name=\"parkcode\" onChange=\"MM_jumpMenu('parent',this,0)\"><option selected>Select Unit...</option>";foreach($menuArrayPark as $k=>$v){	if($parkcode==$v){$s="selected";}else{$s="value";}		echo "<option $s='facility_form.php?parkcode=$v'>$parkCodeName[$v]</option>";       }   echo "</select></td></tr></table></form>";}if(!isset($parkcode)){exit;}// ******* Display ************$database="system_plan";include("../../include/connectROOT.inc"); // database connection parameters//echo "c1=$connection";//exit;  $db = mysql_select_db($database,$connection)       or die ("Couldn't select database");       // Get display name for facilities$sql="SELECT *from facwhere parkcode='$parkcode'order by fld_name";//echo "$sql"; //exit;$result = @MYSQL_QUERY($sql,$connection);	while($row=mysql_fetch_assoc($result)){$FAC_DISPLAY[]=$row;}//echo "<pre>"; print_r($FAC_DISPLAY); echo "</pre>";  exit;include("../../include/connectDIVPER.62.inc"); // database connection parameters  $db = mysql_select_db($database,$connection)       or die ("Couldn't select database");//echo "c2=$connection";exit;if($parkcode=="JONE"){$where="OR t1.parkcode='SALA'";}$sql="SELECT county, class, class_type, sum(acres_land) as acres_land, sum(acres_water) as acres_water, sum(length_miles) as length_miles, note_1, note_2, park_purpose, inter_themes, park_summary, trail_summaryfrom dpr_acres as t1LEFT JOIN dprunit as t2 on t2.parkcode=t1.parkcodewhere t1.parkcode='$parkcode' $wheregroup by t1.parkcode,class,class_typeorder by class";//echo "$sql"; //exit;$result = @MYSQL_QUERY($sql,$connection);	while($row=mysql_fetch_assoc($result)){$PARK_INFO[]=$row;}//echo "<pre>"; print_r($PARK_INFO); echo "</pre>"; // exit;$sql="SELECT fac_name, fac_desc, sum(number) as numberfrom facility_desc as t1LEFT JOIN dprunit as t2 on t2.parkcode=t1.parkcodewhere t1.parkcode='$parkcode'group by t1.parkcode,fac_nameorder by fac_name";//echo "$sql"; //exit;$result = @MYSQL_QUERY($sql,$connection);	while($row=mysql_fetch_assoc($result)){$FACILITY[]=$row;}//echo "<pre>"; print_r($FACILITY); echo "</pre>"; // exit;// Staff$sql="SELECT working_title as position, count(seid) as numfrom position where park='$parkcode' AND code='$parkcode'group by position order by current_salary desc";//echo "$sql"; //exit;$result = @MYSQL_QUERY($sql,$connection);	while($row=mysql_fetch_assoc($result)){$POSITION1[]=$row;}//echo "<pre>"; print_r($POSITION); echo "</pre>"; // exit;include("../../include/connect195.inc"); // database connection parameters$sql="SELECT posTitle as position, beacon_title as position_beacon, count(id) as numfrom seasonal_payrollwhere center_code='$parkcode' and f_year='$f_year' and posTitle!=''group by posTitle order by num desc";$result = @MYSQL_QUERY($sql,$connection);//echo "$sql r=$result"; //exit;while($row=mysql_fetch_assoc($result)){$POSITION2[]=$row;}$database="photos";  $db = mysql_select_db($database,$connection)       or die ("Couldn't select database");$sql="SELECT linkfrom photos.imageswhere park='$parkcode' and sys_plan='x'";$result = @MYSQL_QUERY($sql,$connection);//echo "$sql r=$result"; //exit;$row=mysql_fetch_assoc($result);{	if($row['link']!=""){$var=explode("/",$row['link']);$var640="640.".$var[3];$link="http://149.168.1.195/photos/".$var[0]."/".$var[1]."/".$var[2]."/".$var640;}}include("../../include/connect196.inc"); // database connection parameters$database="park_use";  $db = mysql_select_db($database,$connection)       or die ("Couldn't select database");       $sql="SELECT fld_name as fac_name, category_desc as fac_descFROM `categories`left join park_category on park_category.category=categories.category_idWHERE park_id='$parkcode'";//echo "$sql"; //exit;$result = @MYSQL_QUERY($sql,$connection);	while($row=mysql_fetch_assoc($result)){$FACILITY[]=$row;}//echo "<pre>"; print_r($FACILITY); echo "</pre>"; // exit;$sql="SELECT sum(attend_tot) as visit_prevfrom statswhere park='$parkcode' and left(year_month_week,4)='$prev_yr'group by left(year_month_week,4)";$result = @MYSQL_QUERY($sql,$connection);	$row=mysql_fetch_assoc($result);if($row){extract($row);}$sql="SELECT sum(attend_tot) as visit_pentfrom statswhere park='$parkcode' and left(year_month_week,4)='$pent_yr'group by left(year_month_week,4)";$result = @MYSQL_QUERY($sql,$connection);	$row=mysql_fetch_assoc($result);if($row){extract($row);}// ***************************IF($rep==""){echo "<body><div align='center'><table align='center' cellpadding='5'>";// Park Nameecho "<tr><td colspan='12' align='center'><font color='brown' size='+2'><b>$parkCodeName[$parkcode]</b></font></td></tr>";}else {$pdf=new PDF();$pdf->SetTitle("Interpretive Themes");//First page$left_margin=20;$pdf->SetLeftMargin($left_margin);$pdf->SetRightMargin(20);$pdf->AddPage();$pdf->SetFont('Arial','',18);$pdf->SetX(20);//$pdf->Write(1,$parkCodeName[$parkcode]);$pdf->Cell(0,0,$parkCodeName[$parkcode],0,0,C);$pdf->Image("pale_logo.jpeg",175,5,25);$pdf->SetFont('Arial','',5);$pdf->SetTextColor(140);$pdf->Cell(-5.2,-4,"N.C. Division of Parks & Recreation",0,0,C);$pdf->SetTextColor(0);}// Park Summary$ps=$PARK_INFO[0]['park_summary'];IF($rep==""){$ps=nl2br($ps);echo "<tr><td valign='top' align='right'>Park <a href='https://www.ncstateparks.net/divper/contactInfoUnit.php?parkcode=$parkcode' target='_blank'>Summary</a></td><td>$ps</td></tr>";}else{$pdf->SetY(20);$pdf->SetFont('Times','',11);if($ps==""){$ps="The summary information for this park has not yet been entered.\n\n";}else{$ps.="\n\n";}$pdf_text="Summary\n".$ps;}/*// Park Purpose$pp=$PARK_INFO[0]['park_purpose'];IF($rep==""){$pp=nl2br($pp);echo "<tr><td valign='top' align='right'><a href='https://www.ncstateparks.net/divper/contactInfoUnit.php?parkcode=$parkcode' target='_blank'>Purpose</a></td><td>$pp</td></tr>";}else{if($pp!=""){$pdf_text.="Purpose\n";$pdf_text.=$pp."\n\n";}}*/// Interpretive themes$it=$PARK_INFO[0]['inter_themes'];IF($rep==""){$it=nl2br($it);echo "<tr><td valign='top' align='right'><a href='https://www.ncstateparks.net/divper/contactInfoUnit.php?parkcode=$parkcode' target='_blank'>Interpretive Themes</a></td><td>$it</td></tr></table>";}else{$pdf_text.="Interpretive Themes\n".$it;}//Acreageforeach($PARK_INFO as $k=>$v){	foreach($v as $k1=>$v1){		if($k1=="acres_land"){$land+=$v1;}		if($k1=="acres_water"){$water+=$v1;}		}	}if($land>0){$acres_land=number_format($land,0)." land acres";}if($water>0){$acres_water=number_format($water,0)." water acres";}// Miles for State Rivers and State Trailsforeach($PARK_INFO AS $k=>$v){		foreach($v as $k1=>$v1){			if($k1=="class_type" and $PARK_INFO[$k]['length_miles']>0){$type[]=$v1." - ".$PARK_INFO[$k]['length_miles'];}			}		}		if($type){$type=array_unique($type);		foreach($type as $k=>$v){			$varType.="$v miles<br />";			$pdfType.="[$v miles] ";			}$varType="<b>State River</b><br />".$varType;			}$note_1=$PARK_INFO[0]['note_1'];$note_2=$PARK_INFO[0]['note_2'];IF($rep==""){echo "<table border='1' cellpadding='3'><tr><td align='center'><a href='https://www.ncstateparks.net:443/divper/land_acres.php?parkcode=$parkcode' target='_blank'>Acreage</a> (as of $prev_yr)<br /> <b>$acres_land</b><br /><b>$acres_water</b></td><td>$note_1</td><td>$note_2</td><td>$varType</td>";}else{$pdf_text.="\n\nAcreage (as of $prev_yr): [$acres_land]";if($acres_water){$pdf_text.=" [$acres_water]";}}if($rep==1 and $pdfType!=""){		$pdf_text.="\nState River: $pdfType";		}//County$county=$PARK_INFO[0]['county'];IF($rep==""){echo "<td>County: <b>$county</b></td></tr>";}//Visitation$visitation1=number_format($visit_prev,0);//$visitation2=number_format($visit_pent,0);IF($rep==""){echo "<tr><td>Visitation ($prev_yr): <b>$visitation1</b></td>";//<td colspan='4'>Visitation ($pent_yr): <b>$visitation2</b></td>echo "</tr></table>";}else{$pdf_text.="     Visitation ($prev_yr): $visitation1";$split=explode(",",$county);	if(count($split)>1){$varCounty="Counties:";}else{$varCounty="County:";}$pdf_text.="         $varCounty $county";		$y = $pdf->GetY();$pdf->Write(4,$pdf_text);//$pdf->Output();//exit;}//Facilities	// Report Display//	echo "<pre>"; print_r($FAC_DISPLAY); echo "</pre>"; // exit;IF($FAC_DISPLAY){$skip=array("id");	IF($rep==""){echo "<form name='form_1' action='fac_form.php' method='POST'><table border='1' cellpadding='10'><tr><td colspan='12'><b>Visitor Facilities  (as of $prev_yr)</b> <font color='green'>Report</font></td></tr>";echo "<tr><th>Select</th><th>field_name<br />Doesn't show on report</th><th>Park</th><th>Facility Name<br />Shows on Report</th><th>Number</th></tr>";}	else {		$pdf->SetX(20);		$pdf_text="Visitor Facilities  (as of $prev_yr)";		$pdf->Cell(0,$y,$pdf_text);		}}$database="system_plan";include("../../include/connectROOT.inc"); // database connection parameters  $db = mysql_select_db($database,$connection)       or die ("Couldn't select database");       if($FAC_DISPLAY!=""){foreach($FAC_DISPLAY as $k=>$v){	IF($rep==""){		echo "<tr><td>		<input type='checkbox' name='fac_array[$v[fld_name]]' value=\"$v[display_name]\">				<input type='hidden' name='fac_num[$v[fld_name]]' value='$v[number]'>		</td>";}			foreach($v as $fld=>$value){					if(in_array($fld,$skip)){continue;}					if($fld=="display_name"){					if($value==""){					$sql="SELECT display_name as value					FROM `fac`					WHERE fld_name='$v[fld_name]'"; //echo "$sql";exit;					$resultFac = @MYSQL_QUERY($sql,$connection);					$xx=mysql_num_rows($resultFac);					if($xx>0){					$rowFac=mysql_fetch_assoc($resultFac);					extract($rowFac);}					}				IF($rep==""){					$value.="<br /><a href='edit_fld_name.php?parkcode=$parkcode&fac_name=$v[fld_name]'><font size='-2'>Change default facility name on Report or delete</font></a>";}					else {$fac_cell.=$value." ";}							}												if($fld=="number"){						if($value>1){$fac_cell.="=> ".$value;}						}				IF($rep==""){						echo "<td>$value</td>";}				} 		IF($rep==""){echo "</tr>";} else {$fac_cell.="\n";}			}// end foreach}				IF($rep==""){		echo "<tr><td colspan='2' align='left'>		<input name='btn' type='button' onclick='CheckAll_1()' value='Check All'> <input name='btn' type='button' onclick='UncheckAll_1()' value='Uncheck All'></td><td colspan='4' align='center'>		<input type='hidden' name='parkcode' value='$parkcode'>		<input type='submit' name='submit' value='Make Selections'>		</td></tr></form>";		echo "<form action='add_fac.php' method='POST'><tr><td>&nbsp;</td><td><input type='text' name='fld_name'></td><td><input type='text' name='parkcode' value='$parkcode' READONLY></td><td><input type='text' name='display_name' size='75'></td><td><input type='text' name='number'></td><td><input type='submit' name='submit' value='Add'></td></tr></form>";echo "</table>";	}if($rep==1 and $pdf_text!=""){$pdf_text=$fac_cell;		$y = $pdf->GetY()+13;		$pdf->SetXY(25,$y);$pdf->MultiCell(0,4.1,$pdf_text);//$pdf->Output();//exit;}		//echo "<pre>"; print_r($FACILITY); echo "</pre>"; // exit;	// Raw Data$skip=array("class_type","county","acres_land","acres_water","length_miles","park_purpose","inter_themes","note_1","note_2");$skipValues=array("special_activity_permit","attend_tot","family_inv","family_occ","family_oos","family_is","group_inv","group_occ","group_camp_tot","csw_hours","csw_number");	IF($rep==""){echo "<form name='form_2' action='fac_form.php' method='POST'><table border='1' cellpadding='10'><tr><td colspan='12'><b>Visitor Facilities  (as of $prev_yr)</b> <font color='red'>Raw Data</font></td></tr>";echo "<tr><th>Select</th>";foreach($FACILITY[0] as $k=>$v){	if(!in_array($k,$skip)){echo "<th>$k</th>";}			}		echo "</tr>";		if($FACILITY[1]){foreach($FACILITY as $k=>$v){				if(in_array($FACILITY[$k]['fac_name'],$skipValues)){continue;}		echo "<tr><td>		<input type='checkbox' name='fac_array[$v[fac_name]]' value=\"$v[fac_desc]\">				<input type='hidden' name='fac_num[$v[fac_name]]' value='$v[number]'>		</td>";				foreach($v as $fld=>$value){					if(in_array($fld,$skip)){continue;}						echo "<td>$value</td>";}		echo "</tr>";		}		echo "<tr><td colspan='4' align='center'>		<input name='btn' type='button' onclick='CheckAll_2()' value='Check All'> <input name='btn' type='button' onclick='UncheckAll_2()' value='Uncheck All'> 		<input type='hidden' name='parkcode' value='$parkcode'>		<input type='submit' name='submit' value='Make Selections'>		</td></tr>";echo "</table></form>";		}}// Trail Miles$ps=$PARK_INFO[0]['trail_summary'];	IF($rep==""){$ps=nl2br($ps);//$text="Park Trail <a href='https://www.ncstateparks.net/divper/contactInfoUnit.php?parkcode=$parkcode' target='_blank'>Summary</a>";$text="Park Trail Summary: Not being included at this time.";echo "<table border='1' cellpadding='10'><tr><td valign='top' align='right'>$text</td></tr></table>";//Staffecho "<table><tr><td align='center' colspan='5' valign='bottom' height='40'><b>Staff (as of $prev_yr)</b></td></tr>";}/*if($rep==1){$pdf_text="Trail Summary: $ps";		$y = $pdf->GetY()+5;		$pdf->SetXY(20,$y);$pdf->MultiCell(0,4.1,$pdf_text);//$pdf->Output();//exit;}*/if($FACILITY[1]){	IF($rep==""){echo "<tr><td valign='top'><table border='1' cellpadding='10'>";	echo "<tr><td align='center' colspan='2'><b>Permanent</b></td></tr>";	} else {$pos="     Permanent Staff\n"; $num="\n";}	foreach($POSITION1 as $k=>$v){		IF($rep==""){	echo "<tr>";}			foreach($v as $fld=>$value){			IF($rep==""){		echo "<td>$value</td>";}					else{					if($fld=="position"){						$sl=$pdf->GetStringWidth($value);						if($sl>$sl_max){$sl_max=$sl;}						$pos.=$value."\n";}					if($fld=="num"){$num.=$value."\n";}					}				}		IF($rep==""){	echo "</tr>";	}		}if($rep==1){$pdf_text=$pos;	$staff_margin=55;		$y = $pdf->GetY()+5;		$pdf->SetXY($staff_margin,$y);$pdf->MultiCell(0,4.1,$pdf_text); $pdf_text=$num;$x=$staff_margin+$sl_max+3;		$pdf->SetXY($x,$y);$pdf->MultiCell(0,4.1,$pdf_text); $staff_y=$pdf->GetY();//$pdf->Output();//exit;}	IF($rep==""){		echo "</table></td><td valign='top'><table border='1' cellpadding='10'>";	echo "<tr><td align='center' colspan='2'><b>Seasonal</b></td></tr>";	} else {$pos="     Seasonal Staff\n"; $num="\n";}	foreach($POSITION2 as $k=>$v){			IF($rep==""){echo "<tr>";}			foreach($v as $fld=>$value){					IF($rep==""){				if($value=="none"){continue;}				echo "<td>$value</td>";}else{					if($fld=="position"){						if($value=="none"){$value=$v['position_beacon'];}						$sl=$pdf->GetStringWidth($value);						if($sl>$sl_maxS){$sl_maxS=$sl;}						$pos.=$value."\n";}					if($fld=="num"){$num.=$value."\n";}					}				}			IF($rep==""){echo "</tr>";}					}	IF($rep==""){echo "</table></td></tr>";}	}	IF($rep==""){echo "</table>";}if($rep==1){$pdf_text=$pos;		$x = $sl_max+$staff_margin+25;		$pdf->SetXY($x,$y);$pdf->MultiCell(0,4.1,$pdf_text);$pdf_text=$num;$x=$x+$sl_maxS+3;		$pdf->SetXY($x,$y);$pdf->MultiCell(0,4.1,$pdf_text); $seasonal_y=$pdf->GetY();$x=$left_margin+12;if($staff_y>$seasonal_y){$y=$staff_y;}else{$y=$seasonal_y;}//$pdf->Write(4,$y);if($link!="" AND $y<190){	$y+=10;	$pdf->Image($link,$x,$y,140);}$pdf->Output("Interpretive Themes.pdf",I);exit;}echo "</div></body></html>";/*// Operating Expensesinclude("../../include/connect195.inc"); // database connection parameters$sql="SELECT f_year,budget_group,cash_type,center,parkcode,district,section,sum(amount) as 'amount' from report_budget_history where 1 and f_year='$pf_year' and parkcode='$parkcode' group by f_year,budget_group,parkcode,cash_type order by f_year,budget_group,parkcode,cash_type";$result = @MYSQL_QUERY($sql,$connection);	echo "<table border='1' cellpadding='10'><tr><td colspan='12' align='center'><b>(FY $pf_year) Budget Summary </b></td></tr>";while($row=mysql_fetch_assoc($result)){extract($row); $amt=number_format($amount,2);$tot+=$amount;echo "<tr><td>$budget_group</td><td>$cash_type</td><td align='right'>$amt</td></tr>";}$tot=number_format($tot,2);echo "<tr><td colspan='3' align='right'>$tot</td></tr>";echo "</table>";*/?>