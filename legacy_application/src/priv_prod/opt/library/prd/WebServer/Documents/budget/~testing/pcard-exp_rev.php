<?php//These are placed outside of the webserver directory for security//include("../../include/authBUDGET.inc"); // used to authenticate usersinclude("../../../include/connectBUDGET.inc");// database connection parameters//include("menu.php");extract($_REQUEST);$sql = "SELECT center,acct,sum(credit-debit) as erAmt FROM exp_rev WHERE acctdate >='20050701' and acctdate<= '20051208' and description ='purchasingcard' and fund='1280' and (acct like '532%' or acct like '533%' or acct like '534%' or acct like '535%') GROUP by center,acct ORDER by center,acct";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query. $sql");while($row=mysqli_fetch_array($result)){extract($row);//$id0=$acct.$center;$exp_revARid[$id0]=($erAmt);$id0=$center.$acct;$exp_revARid[$id0]=($erAmt);}echo "Testing Links<br>Exp_Rev vs. Pcard  <a href='/budget/~testing/pcard-exp_rev.php'>Both Matches and Exceptions</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exp_Rev vs. Pcard  <a href='/budget/~testing/pcard-exp_rev.php?e=1'>Only Exceptions</a><br><br>$sql<br><br>";$sql = "SELECT center,acct,sum(amt) as pcAmt FROM  pcard WHERE newpostdate >='20050616' AND payst =  'P' and center like '1280%' and (acct like '532%' or acct like '533%' or acct like '534%' or acct like '535%') and newpostdate <= '20051208'GROUP by center,acct ORDER by center,acct";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query. $sql");echo "$sql<br><br>";while($row=mysqli_fetch_array($result)){extract($row);//$id1=$acct.$center;$pcardARid[$id1]=($pcAmt);$id1=$center.$acct;$pcardARid[$id1]=($pcAmt);}reset($exp_revARid);while(list($key,$val)=each($exp_revARid)){$totExpRev=$totExpRev+$val;$totPcard=$totPcard+$pcardARid[$key];if(abs($val)!=abs($pcardARid[$key])){$totRed=$totRed+$val;$f1="<font color='red'>";$f2="</font>";if($pcardARid[$key]){echo "$f1$key = Exp-Rev $val  ==>  Pcard $pcardARid[$key]$f2<br>";}else{$totPurple=$totPurple+$pcardARid[$key];$f1="<font color='purple'>";$f2="</font>";echo "$f1$key = Exp-Rev $val  ==>  Pcard has no value. $f2<br>";}}else{$f1="";$f2="";if($e==""){echo "$f1$key = Exp-Rev $val  ==>  Pcard $pcardARid[$key]$f2<br>";}}}$x=abs($totExpRev)-$totPcard;$y=number_format($totRed,2);$a=number_format($totExpRev,2);$b=number_format($totPcard,2);$c=number_format($x,2);echo "<br><br>Total Exp_Rev = $a  (total of purchase card credit - debit, not abs val)<br><br>Total Pcard = $b<br><br>Difference1 = $c  includes both red and purple<br><br>Total Red = $y<br><br>Total Purple = $totPurple";?>