<?php  include "class.dropshadow.php";  $ds = new dropShadow();  $ds->setDebugging(FALSE);  $ds->setImageSize("120");  $ds->setImageType("jpg");  if (!isset($_GET['fname']))  {     if ($dir = @opendir("images"))     {        $count = 0;        $total = 0;        $imgrows = "<tr>\n";        echo "<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\">\n";        // go through all files        while ($node = @readdir($dir))        {           $fname = basename($node);           if ($node != "." && $node != ".." && !ereg("^_thu",$fname))           {              if (!file_exists("images/_thu$fname"))              {                 $ds->createDropShadow("images/{$fname}","images/_thu{$fname}",array(255,255,255));              }              $sizes = @GetImageSize("images/_thu{$fname}");              $imgrows .= "  <td align=\"center\" valign=\"middle\"><a href=\"{$_SERVER['PHP_SELF']}?fname={$fname}\"><img src=\"images/_thu{$fname}\" border=\"0\" alt=\"\" {$sizes[3]}></a></td>\n";              if (++$count == 4)              {                 echo "$imgrows</tr>\n<tr><td colspan=\"{$cfgVars['width_column']}\">&nbsp;<br>&nbsp;</td></tr>\n";                 $imgrows = "<tr>\n";                 $count = 0;              }              ++$total;           }        }        if (!$total)        {           echo "<tr><td>No images were found.</td></tr>\n";        }        echo "$imgrows</tr>\n</table>\n";     }     else echo '<p>The image directory could not be opened for viewing... Sorry!</p>';  }  else  {     echo "<p><a href=\"index.php\">Return to the list of images</a></p>\n";     $sizes = GetImageSize("images/$fname");     echo "<p><img src=\"images/{$fname}\" border=\"0\" {$sizes[3]} alt=\"\"></p>\n";  }  ?>  ****************************************************  // Additional pointers from authorCode:    function createThumbnail($input="", $output="", $isstring=FALSE, $dosave = TRUE)     {        $this->createDropShadow($input, $output, array(255,255,255), $isstring, 1, $dosave);     }     // does the grunt work of putting all the images together     // $input      = directory/filename you wish to save to     // $output     = directory/filename you wish to save to     // $background = array of ints representing the RGB value, eg, array(255,255,255) - white     // $isstring   = set to 1 if the $input will be a string representing the image, as you     //               might draw from a database.     function createDropShadow($input="", $output="", $background=array(), $isstring=FALSE, $withoutshadow=0, $dosave = TRUE)     {  then in the createDropshadow function I update the saving part to look like this: Code:          if ($dosave)           {              if (!$this->saveImage($this->_image_array['output'], $output))              {                 $this->debug("The resized image could not be saved.");                 return FALSE;              }              else return TRUE;           }                      return TRUE;  And so to generate the dropshadow on the fly and display it I use a line like this: Code: echo '<br><table border="0" cellpadding="0" cellspacing="0" align="center"><tr><td colspan="2"><img src="show_image.php?id='.$_GET['image_id'].'" border="0" title="'.$images[$oncount]['title'].'"></td></tr>';  and the 'show_image.php' file looks like this: Code: <?php     require './mypath/config.php';     require './mypath/class.dropshadow.php';     $ds = new dropShadow();     $ds->setImageSize(0);     $ds->setImageType('jpg');     $ds->setShadowPath('./images/dropshadow');     $ds->createDropShadow("./images/gallery/{$_GET['id']}.jpg", "./images/gallery/{$_GET['id']}.jpg", array(218,218,218), FALSE);     $ds->showImage();  ?> 