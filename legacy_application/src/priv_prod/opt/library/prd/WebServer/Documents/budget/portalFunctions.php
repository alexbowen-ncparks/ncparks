<?php// *************** PMIS FUNCTIONS **************function findMe($fld,$passSQL){$findme=urlencode(" order by ");$pos=strpos($passSQL,$findme);if($pos>0){$flds = array("age","location","eeid");$removeFld = str_replace($flds, "", $passSQL);$passSQL=$removeFld.urlencode("$fld");}else{$passSQL=$passSQL.urlencode(" order by $fld");}return $passSQL;}function portalHeader($passSQL,$passFields,$countKeys,$sumBy,$totHeader,$countHeader,$rep){global $numOfColumns,$fld,$countKeys,$lastFld;// pass to itemShow//,$fld0Dec,$fld1Dec,$fld2Dec,$fld3Dec,$fld4Dec,$fld5Dec,$fld6Dec,$fld7Dec//print_r($passFields);//exit;$fld=explode(",",$passFields);// Put Field Names in an Array$c=count($fld)-1;$lastFld=$fld[$c];for($zz=0;$zz<$countKeys;$zz++){$q="fld".$zz."Dec";$r=${$q};$zSum[]="SUM".$r;}if($totHeader){array_unshift($fld, "Total");}if($countHeader){for($zz=0;$zz<$countHeader;$zz++){array_unshift($fld, "Count");}}//$zSum=array_reverse($zSum);for($zz=0;$zz<count(@$zSum);$zz++){array_unshift($fld, $zSum[$zz]);}if($countKeys<1 and $sumBy){//array_unshift($fld, "Count");}//print_r($fld);//exit;$numOfColumns=count($fld);//$link="<a href='portal.php?park=$park'>$park</a>";for($x=0;$x<$numOfColumns;$x++){if($rep=="excel"){$var=strtoupper($fld[$x]);}else{$var=strtoupper(str_replace("_","<br>",$fld[$x]));}if($var!="CIAD" AND $var!="CAA6"){if($var=="ACCT6"){$var="ACCT";}echo "<th>$var</th>";}}// end if !ciadecho "</tr>";}function getDecimalFields($varE){//global $fld0Dec,$fld1Dec,$fld2Dec,$fld3Dec,$fld4Dec,$fld5Dec,$fld6Dec,$fld7Dec;$decimalKeys=array_keys($varE);for($dkc=0;$dkc<count($varE);$dkc++){// set Global variables$string1="fld".$dkc."Dec";global ${$string1};}for($dkc=0;$dkc<count($varE);$dkc++){$string1="fld".$dkc."Dec";${$string1}=$decimalKeys[$dkc];}/*$fld0Dec=$decimalKeys[0];$fld1Dec=$decimalKeys[1];$fld2Dec=$decimalKeys[2];*/}function itemShow($row,$passSQL,$dbTable,$sumBy,$varE,$decimalValues){global $total1,$numOfColumns,$countKeys,$lastFld,$totHeader,$fld,$totFld11;//,$totFld1$decimalKeys=array_keys($varE);for($dkc=0;$dkc<count($varE);$dkc++){// set Global variables$string1="fld".$dkc."Dec";$string2="fld".$dkc."Tot";global ${$string1};global ${$string2};}//,$fld0Tot,$fld1Tot,$fld2Tot,$fld3Tot,$fld4Tot,$fld5Tot,$fld6Tot,$fld7Tot//,$fld0Dec,$fld1Dec,$fld2Dec,$fld3Dec,$fld4Dec,$fld5Dec,$fld6Dec,$fld7Dec//$totFld1=$totFld1+$fld1;extract($row);//$t0=${$fld0Dec};//$t1=${$fld1Dec};$t2=${$fld2Dec};$t3=${$fld3Dec};$t4=${$fld4Dec};$t5=${$fld5Dec};$t6=${$fld6Dec};$t7=${$fld7Dec};/*for($dkc=0;$dkc<count($varE);$dkc++){// set display variables$string1="fld".$dkc."Dec";$string2="fld".$dkc."Tot";$vt[]=${$string1};}*/$fld0Tot+=${$fld0Dec};$fld1Tot+=${$fld1Dec};$fld2Tot+=${$fld2Dec};$fld3Tot+=${$fld3Dec};$fld4Tot+=${$fld4Dec};$fld5Tot+=${$fld5Dec};$fld6Tot+=${$fld6Dec};$fld7Tot+=${$fld7Dec};$fld8Tot+=${$fld8Dec};$fld9Tot+=${$fld9Dec};$fld10Tot+=${$fld10Dec};$fld11Tot+=${$fld11Dec};$fld12Tot+=${$fld12Dec};$fld13Tot+=${$fld13Dec};$fld14Tot+=${$fld14Dec};/*$fld0Tot+=$t0;$fld1Tot+=$t1;$fld2Tot+=$t2;*/$dv=array_values($decimalValues);//echo "d=$totHeader";//print_r($decimalValues);exit;if($sumBy){$total1=$total1+$row[0];if($countKeys==1){$colPositionA=$dv[0]+$countKeys;}if($countKeys==2){$colPositionA=$dv[0]+$countKeys;$colPositionB=$dv[1]+$countKeys;if($totHeader){$colPositionA=$$colPositionA+1;$colPositionB=$colPositionB+1;}}}else{$total1=$total1+$amt;$col0=$dv[0];$col1=$dv[1];$col2=$dv[2];$col3=$dv[3];$col4=$dv[4];$col5=$dv[5];$col6=$dv[6];$col7=$dv[7];$col8=$dv[8];$col9=$dv[9];$col10=$dv[10];$col11=$dv[11];$col12=$dv[12];$col13=$dv[13];$col14=$dv[14];//echo "3=$col3";exit;}echo "<tr>";for($x=0;$x<$numOfColumns;$x++){$var=$row[$x];$fldName=strtoupper($fld[$x]);if($fldName!="CIAD" AND $fldName!="CAA6"){if($x==$numOfColumns-1){$var="<a href='portal.php?dbTable=$dbTable&lastFld=$lastFld&var=$var'>$var</a>";}/*if($dv and ($x===$colPositionA||$x===$colPositionB ||$x==$col0|| ($x<$countKeys))){*/$pos=strpos($var,".");$testVar=is_finite($var);if($pos>-1 and $testVar){$var1=number_format($var,2);if($var<0){$bn="<font color='red'>";$bd="</font>";}else{$bn="";$be="";}echo "<td align='right'>$bn$var1$be</td>";}else{echo "<td>$var</td>";}}}echo "</tr>";}?>