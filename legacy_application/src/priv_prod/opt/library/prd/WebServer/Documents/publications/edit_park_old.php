<?php//These are placed outside of the webserver directory for securityinclude("../../../include/authDIVPER.inc"); // used to authenticate users$database="publications";include("../../../include/connectROOT.inc"); // database connection parameters//include("css/TDnull.inc");include("../menu.php");include("pm_menu.php");if($submit=="Add"){$sql="INSERT INTO publications.subunits set parkcode='$parkcode',subunit='$sub'"; $result = @MYSQL_QUERY($sql,$connection);}if($submit=="Update"){//echo "<pre>";print_r($_POST);echo "</pre>";foreach($_POST AS $k=>$v){	foreach($v as $key=>$value){	if($value){$insertString.= "parkcode='$parkcode', subunit='$key', $k='$value'<br>";$sql="INSERT INTO publications.subunits set $insertString";echo "$sql<br>"; $insertString="";}	}//$result = @MYSQL_QUERY($sql,$connection);}}// ********** Get Field Types *********$sql="SHOW COLUMNS FROM publications.brochures"; $result = @MYSQL_QUERY($sql,$connection);while($row=mysql_fetch_assoc($result)){$allFields[]=$row[Field];if(strpos($row[Type],"decimal")>-1){	$decimalFields[]=$row[Field];	$tempVar=explode(",",$row[Type]);	$decPoint[$row[Field]]=trim($tempVar[1],")");	}}//print_r($allFields);// ******** Enter your SELECT statement here **********$sql="SELECT * FROM subunits where parkcode='$parkcode'"; $result = @MYSQL_QUERY($sql,$connection);while($row=mysql_fetch_assoc($result)){$ARRAY[]=$row;}$num=mysql_num_rows($result);$numFields=count($allFields);$fieldNames=array_values(array_keys($ARRAY[0]));//echo "<pre>";print_r($ARRAY);echo "</pre>";if($parkcode){$pc=$parkcode;}else{$pc=$ARRAY[0]['parkcode'];}$sql="SELECT * FROM subunits where parkcode='$pc' order by subunit"; $result = @MYSQL_QUERY($sql,$connection);while($row=mysql_fetch_assoc($result)){$ARRAYsub[]=$row;}$numSub=mysql_num_rows($result);$u = ($numSub==1 ? 'unit' : 'units');echo "<html><table border='1' cellpadding='2'><tr><td colspan='$numFields' align='center'><font color='red'>Tracking $numSub $u for $pc</font></td></tr>";IF($numSub<1){echo "<tr><td align='right'>Create SubUnit: </td><td><form><input type='text' name='sub' value='Entire Park'><input type='hidden' name='parkcode' value='$pc'><input type='submit' name='submit' value='Add'></form></td></tr><tr><td width='400'>If printed material is for <b>the entire park</b>, and not for subunits, leave Entire Park in the box and click the Add button.</td></tr><tr><td width='400'>If printed material needs to be tracked for separate areas within the park, enter name of that area and click the Add button. You will be able to create additional subunit records.</td></tr>";exit;}echo "<form method='POST'>";$skipArray=array("id","modified","parkcode","subunit",);foreach($ARRAY as $k=>$v){// each row// $fx = font color  and  $tr = row shading//$f1="";$f2="";$j++;//if(fmod($j,2)!=0){$tr=" bgcolor='aliceblue'";}else{$tr="";}	foreach($v as $k1=>$v1){// each field, e.g., $tempID=$v[tempID];		if(in_array($k1,$decimalFields)){		$total[$k1]+=$v1;		$v1=number_format($v1,$decPoint[$k1]);							}		if(!in_array($k1,$skipArray)){if($fieldNames[$i]=="subunit"){$tr=" bgcolor='aliceblue'";}else{$tr="";}			$n=$k1."[$v[subunit]]";		$v1="<input type='text' name='$n' value='$v1'>";}			echo "<tr$tr><td>$fieldNames[$i]</td><td align='CENTER'>$v1</td></tr>";	$i++;}$i=0;}echo "<tr>";echo "<td colspan='2' align='right'><input type='submit' name='submit' value='Update'></td>";echo "</tr></form></table>";IF($numSub>0){echo "<table><tr><td align='right'>Create SubUnit: </td><td><form><input type='text' name='sub' value=''><input type='hidden' name='parkcode' value='$pc'><input type='submit' name='submit' value='Add'></form></td></tr><tr><td width='400'>If printed material needs to be <b>tracked for separate areas</b> within the park, enter name of that area and click the Add button. You will be able to create additional subunit records.</td></tr></table>";}echo "</body></html>";?>