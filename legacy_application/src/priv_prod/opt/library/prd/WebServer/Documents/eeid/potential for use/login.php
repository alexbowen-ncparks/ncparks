<?php/* Program: Login.php   Desc:    Login program for the Registered Users section. It provides two options: (1) login using an existing Login Name and (2) enter a new login name. Login Names and passwords are stored in a MySQL database.  */ extract ($_REQUEST);//print_r($_REQUEST);//exit; require_once("../../include/connectEEID.inc");  switch (@$do)  {    case "login":      $connection = mysql_connect($host, $user,$EEIDpassword)               or die ("Couldn't connect to server. E1");      $db = mysql_select_db($database, $connection)               or die ("Couldn't select database.");      $sql = "SELECT loginName FROM member              WHERE loginName='$username'";  //echo "$sql"; exit;      $result = mysql_query($sql)                  or die("Couldn't execute query.");      $num = mysql_num_rows($result);      if ($num == 1)  // login name was found      {         $sql = "SELECT loginName,park FROM member                 WHERE loginName='$username'                 AND password=('$password')";         $result2 = mysql_query($sql)                   or die("Couldn't execute query.");         $num2 = mysql_num_rows($result2);         if ($num2 > 0)  // password is correct         {extract($result2);session_start();$_SESSION['Ruser'] = 'yes';$_SESSION['logname'] = $username;$_SESSION['parkS'] = $park;         $hostadd = $_SERVER['REMOTE_ADDR'];           $today = date("Y-m-d h:m:s");           $sql = "INSERT INTO login (loginName,loginTime,userAdd)                   VALUES ('$username','$today','$hostadd')";           mysql_query($sql) or die("Can't execute query.");           header("Location: loginNew.php?fusername=$username&fpassword=$password");         }         else    // password is not correct         {           unset($do);           $message="The Login Name, '$username' exists,                     but you have not entered the correct                      password! Please try again.<br>";           include("login_form.php");         }       }      elseif ($num == 0)  // login name not found      {            unset($do);                                            // 53         $message = "The Login Name you entered does not                      exist! Please use the adjacent form to create your username and password.<br>";         include("login_form.php");      }    break;                                                      // 58    case "new":                                                 // 60      foreach($HTTP_POST_VARS as $key => $value)      {//echo "$key - $value";        if ($key != "fax")                                      // 63        {          if ($value == "")                                     // 65          {            unset($do);            $message_new = "Required information is missing.                 Please try again.";           include("login_form.php");            exit();          }        }        if (ereg("{Name)",$key))                                // 74        {         if (!ereg("^[A-Za-z' -]{1,50}$",$key))          {           unset($do);           $message_new = "$lastName is not a valid name.                             Please try again.";           include("login_form.php");           exit();         }        }        $$key = strip_tags(trim($value));      }          /* check to see if login name already exists */      $connection = mysql_connect($host,$user,$EEIDpassword)                or die ("Couldn't connect to server. E2");      $db = mysql_select_db($database, $connection)                or die ("Couldn't select database.");      $sql = "SELECT loginName FROM member                 WHERE loginName='$username'"; //echo "$sql"; exit;      $result = mysql_query($sql)                or die("Couldn't execute query. Q2");      $num = mysql_numrows($result);      if ($num > 0)      {        unset($do);        $message_new = "$username already used. Select another                          Username.";        include("login_form.php");        exit();      }      else      {           $today = date("Y-m-d");        $sql = "INSERT INTO member (loginName,createDate,password,                  firstName,lastName,park) VALUES                ('$username','$today','$password',                 '$firstName', '$lastName','$park')";        mysql_query($sql); session_start();$_SESSION['Ruser'] = 'yes';$_SESSION['logname'] = $username;        header("Location: newRegistrant.php");      }    break;    default:        include("login_form.php");  }?>