<?php$dbTable="assets";$file=$dbTable.".php";$fileMenu=$dbTable."_menu.php";//echo "<pre>";print_r($_REQUEST);echo "</pre>";//exit;extract($_REQUEST);// ******** Update Record ***********if($submit=="Update"){include("../../include/connectBUDGET.inc");// database connection parameters//echo "<pre>";print_r($_REQUEST);echo "</pre>"; //exit;// FIELD NAMES are stored in $fieldArray$sql = "SHOW COLUMNS FROM assets";//echo "$sql";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query 1. $sql");while ($row=mysqli_fetch_assoc($result)){extract($row);$fieldName[]=$row[Field];}$updateFields="SET ";for($i=0;$i<count($fieldName);$i++){$tf=str_replace(".","_",$fieldName[$i]);$eField=${$tf};if($fieldName[$i]!="id"){if($i==0){$updateFields.="`".$fieldName[$i]."`='".$eField."'";}else{$updateFields.=",`".$fieldName[$i]."`='".$eField."'";}}// end if fieldName}// end for//echo "$updateFields";exit;$query="update assets $updateFields where id='$editID'";//echo "$query";exit;$result = mysqli_query($connection, $query) or die ("Couldn't execute query 1. $query");header("Location: assets.php?asset_category=$asset_category&parkcode=$parkcode");exit;}include("$fileMenu");// necessary to place this AFTER update script// ******** Show Record to Edit ***********if($e==1){// FIELD NAMES are stored in $fieldArray// FIELD TYPES and SIZES are stored in $fieldType$sql = "SHOW COLUMNS FROM assets";//echo "$sql";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query 2. $sql");$numFlds=mysqli_num_rows($result);while ($row=mysqli_fetch_assoc($result)){extract($row);$fieldName[]=$row[Field];$fieldType[]=$row[Type];}echo "<table border='1' cellpadding='3' align='center'><form>";$sql = "SELECT * FROM assets WHERE id=$id";    $result = mysqli_query($connection, $sql) or die ("Couldn't execute query 3. $sql");    $row = mysqli_fetch_array($result);//echo "<pre>";print_r($row);echo "</pre>";// extract($row); for($i=0;$i<count($fieldName);$i++){$tf=$row[$i];echo "<tr><td><b>$fieldName[$i]</b></td>";if($fieldName[$i]!="id"){echo "<td><input type='text' name='$fieldName[$i]' value='$tf' size='75'></td></tr>";}else{echo "<td>$tf</td></tr>";}}echo "<tr><td>&nbsp;</td><td><input type='hidden' name='editID' value='$id'><input type='submit' name='submit' value='Update'></form></td></tr></table>";exit;}// ******** Show Results ***********// FIELD NAMES are stored in $fieldArray// FIELD TYPES and SIZES are stored in $fieldType$sql = "SHOW COLUMNS FROM assets";//echo "$sql";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query 4. $sql");$numFlds=mysqli_num_rows($result);while ($row=mysqli_fetch_assoc($result)){extract($row);$fieldName[]=$row[Field];$fieldType[]=$row[Type];}//print_r($fieldName);if($parkcode!=""){echo "<table border='1' cellpadding='3' align='center'><tr>";for($i=0;$i<count($fieldName);$i++){echo "<th>$fieldName[$i]</th>";}echo "</tr>";if($parkcode=="all"){$pc="";}else{$pc="parkcode='$parkcode' and ";}$query = "SELECT * FROM assets WHERE $pc asset_category='$asset_category'";//echo "$query";    $result = @mysqli_query($connection, $query,$connection);//echo "<pre>";print_r($row);echo "</pre>";// extract($row); while($row = mysqli_fetch_array($result)){echo "<tr>";for($i=0;$i<count($fieldName);$i++){$t=$row[$i];$vk=$fieldName[$i];if($fieldName[$i]=="asset_cost"){$total=$total+$t;}if($vk=="id"){$tf="<td><a href='assets.php?e=1&id=$t'>$t</a></td>";}if($vk=="asset_cost"){$tn=number_format($t,2);$tf="<td align='right'>$tn</td>";}else{$tf="<td>$t</td>";}echo "$tf";}echo "</tr>";}// end while$total=number_format($total,2);echo "<tr><td colspan='11' align='right'><b>$total</b></td></tr></table>";}// end ifecho "</div></body></html>";?>