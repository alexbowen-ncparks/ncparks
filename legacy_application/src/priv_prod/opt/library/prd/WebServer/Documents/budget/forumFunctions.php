<?php// *************** PMIS FUNCTIONS **************function findMe($fld,$passSQL){$findme=urlencode(" order by ");$pos=strpos($passSQL,$findme);if($pos>0){$flds = array("age","location","eeid");$removeFld = str_replace($flds, "", $passSQL);$passSQL=$removeFld.urlencode("$fld");}else{$passSQL=$passSQL.urlencode(" order by $fld");}return $passSQL;}function forumHeader($passSQL,$passFields,$countKeys,$sumBy,$totHeader,$countHeader){global $numOfColumns,$fld0Dec,$fld1Dec,$fld2Dec,$fld,$countKeys,$lastFld;// pass to itemShow//echo "t=$totHeader";exit;//print_r($passFields);//exit;$fld=explode(",",$passFields);// Put Field Names in an Array$c=count($fld)-1;$lastFld=$fld[$c];for($zz=0;$zz<$countKeys;$zz++){$q="fld".$zz."Dec";$r=${$q};$zSum[]="SUM".$r;}if($totHeader){array_unshift($fld, "Total");}if($countHeader){for($zz=0;$zz<$countHeader;$zz++){array_unshift($fld, "Count");}}//$zSum=array_reverse($zSum);for($zz=0;$zz<count($zSum);$zz++){array_unshift($fld, $zSum[$zz]);}if($countKeys<1 and $sumBy){//array_unshift($fld, "Count");}//print_r($fld);//exit;$numOfColumns=count($fld);//$link="<a href='forum.php?park=$park'>$park</a>";echo "<table border='1' cellpadding='3'><tr>";for($x=0;$x<$numOfColumns;$x++){$var=strtoupper($fld[$x]);if($x==($numOfColumns-1)){$var="View";}echo "<th>$var</th>";}echo "</tr>";}function getDecimalFields($varE){global $fld0Dec,$fld1Dec,$fld2Dec;$decimalKeys=array_keys($varE);$fld0Dec=$decimalKeys[0];$fld1Dec=$decimalKeys[1];$fld2Dec=$decimalKeys[2];}function itemShow($row){global $numFlds;//echo "<pre>";print_r($row);echo "</pre>";//exit;$personID=$row[personID];$submisID=$row[submisID];$sub=substr($row[submitter],0,-2);$message=nl2br($row[submission]);if($row[weblink]){$web=explode(",",$row[weblink]);for($l=0;$l<count($web);$l++){$pre=substr(trim($web[$l]),0,4);$n=$l+1;if($pre=="http"){$link.="&nbsp;&nbsp;&nbsp;<a href='".$web[$l]."' target='_blank'>$web[$l]</a>";}else{$link.="&nbsp;&nbsp;&nbsp;<a href='http://".$web[$l]."' target='_blank'>$web[$l]</a>";}}}$var=$row[forumID];list($year,$month,$dayTime)=explode("-",$row[dateCreate]);list($day,$time)=explode(" ",$dayTime);$varDate=date("l, M d, Y", mktime(0, 0, 0, $month, $day, $year));if($row[replier]){$rep="[".substr($row[replier],0,-2)."]";}echo "<tr><td bgcolor='darkviolet' align='center'><font color='white'><b>$sub</b></font></td><td bgcolor='lavender' width='80%'><font size='+1'><div id=\"topicTitle\">";echo "<b>$row[topic]</b></font> $rep<br>$varDate @ $time  <a onclick=\"toggleDisplay('forumDetails');\" href=\"javascript:void('')\"></td></div><th bgcolor='lavender'><a href='forum.php?submit=reply&lastFld=forumID&var=$var'>Reply</a></th><th bgcolor='lavender'><a href='forum.php?submit=add'>Add</a</th><th bgcolor='lavender'><a href='forum.php?submit=find'>Search</a></th><th bgcolor='lavender'>View <a href='forum.php'>Recent</a></th><th bgcolor='lavender'><a href='forum.php?submit=edit&lastFld=forumID&var=$var'>Edit</a></th></tr>";echo "<div id=\"forumDetails\" style=\"display: none\">";echo "<tr><td align='center' valign='top'>$var</td><td colspan='6' bgcolor='white'>$message<br><br>$link</td></tr></div>";}?>