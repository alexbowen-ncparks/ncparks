<?phpinclude("purchasing_rules_menu.php");extract($_REQUEST);// ******** Update Record ***********if($submit=="Update"){//echo "<pre>";print_r($_REQUEST);echo "</pre>"; //exit;// FIELD NAMES are stored in $fieldArray$sql = "SHOW COLUMNS FROM purchasing_rules";//echo "$sql";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query 1. $sql");while ($row=mysqli_fetch_assoc($result)){extract($row);$fieldName[]=$row[Field];}$updateFields="SET ";for($i=0;$i<count($fieldName);$i++){$tf=str_replace(".","_",$fieldName[$i]);$eField=${$tf};if($fieldName[$i]!="id"){if($i==0){$updateFields.="`".$fieldName[$i]."`='".$eField."'";}else{$updateFields.=",`".$fieldName[$i]."`='".$eField."'";}}// end if fieldName}// end for//echo "$updateFields";exit;$query="update purchasing_rules $updateFields where id='$editID'";echo "$query";exit;$result = mysqli_query($connection, $query) or die ("Couldn't execute query 1. $query");//header("Location: purchasing_rules.php?id=$id");exit;}// ******** Show Record to Edit ***********if($e==1){// FIELD NAMES are stored in $fieldArray// FIELD TYPES and SIZES are stored in $fieldType$sql = "SHOW COLUMNS FROM purchasing_rules";//echo "$sql";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query. $sql");$numFlds=mysqli_num_rows($result);while ($row=mysqli_fetch_assoc($result)){extract($row);$fieldName[]=$row[Field];$fieldType[]=$row[Type];}echo "<table border='1' cellpadding='3' align='center'><form>";$sql = "SELECT * FROM purchasing_rules WHERE id=$id";    $result = mysqli_query($connection, $sql) or die ("Couldn't execute query. $sql");    $row = mysqli_fetch_array($result);//echo "<pre>";print_r($row);echo "</pre>";// extract($row); for($i=0;$i<count($fieldName);$i++){$tf=$row[$i];echo "<tr><td><b>$fieldName[$i]</b></td>";if($fieldName[$i]!="id"){echo "<td><input type='text' name='$fieldName[$i]' value='$tf' size='75'></td></tr>";}else{echo "<td>$tf</td></tr>";}}echo "<tr><td>&nbsp;</td><td><input type='hidden' name='editID' value='$id'><input type='submit' name='submit' value='Update'></form> Comma is replaced by new line in display.</td></tr></table>";exit;}// ******** Show Results ***********// FIELD NAMES are stored in $fieldArray// FIELD TYPES and SIZES are stored in $fieldType$sql = "SHOW COLUMNS FROM purchasing_rules";//echo "$sql";$result = mysqli_query($connection, $sql) or die ("Couldn't execute query. $sql");$numFlds=mysqli_num_rows($result);while ($row=mysqli_fetch_assoc($result)){extract($row);$fieldName[]=$row[Field];$fieldType[]=$row[Type];}//print_r($fieldName);if($id!=""){echo "<table border='1' cellpadding='3' align='center'><tr>";for($i=2;$i<count($fieldName);$i++){echo "<th>$fieldName[$i]</th>";}echo "</tr><tr>";$query = "SELECT * FROM purchasing_rules WHERE id=$id";    $result = @mysqli_query($connection, $query,$connection);    $row = mysqli_fetch_array($result);//echo "<pre>";print_r($row);echo "</pre>";// extract($row); for($i=2;$i<count($fieldName);$i++){$t=$row[$i];$vk=$fieldName[$i];if($vk=="id"){$tf="<a href='purchasing_rules.php?e=1&id=$id'>$t</a>";}else{$tf=str_replace(",","<br>",$t);}echo "<td>$tf</td>";}echo "</tr></table>";}// end ifecho "</div></body></html>";?>